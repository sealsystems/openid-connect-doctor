**Access Identity provides**

Popular companies that offer IdP services include the following:
- Google
- Facebook
- Apple
- Fitbit
- Microsoft
- Box
- Amazon Web Services (AWS)

**How to reach Google IdP**

[Setting up OAuth 2.0](https://developers.google.com/identity/protocols/oauth2/openid-connect#appsetup)

[Obtain OAuth 2.0 credentials](https://developers.google.com/identity/protocols/oauth2/openid-connect#getcredentials)

[Set a redirect URI](https://developers.google.com/identity/protocols/oauth2/openid-connect#setredirecturi)

[Customize the user consent screen](https://developers.google.com/identity/protocols/oauth2/openid-connect#consentpageexperience)


Google and third parties provide libraries that can be used to take care of many
of the implementation details of authenticating users and gaining access to Google APIs.
Examples include Google Sign-In and the Google client libraries, which are available for a variety of platforms.

**Authenticating the user**

Authenticating the user involves obtaining an ID token and validating it.
ID tokens are a standardized feature of OpenID Connect designed for use in sharing identity assertions on the Internet.
The most commonly used approaches for authenticating a user and obtaining an ID token are called the "server" flow and the "implicit" flow.
The server flow allows the back-end server of an application to verify the identity of the person using a browser or mobile device.
The implicit flow is used when a client-side application (typically a JavaScript app running in the browser)
needs to access APIs directly instead of via its back-end server.

The implicit flow is significantly more complicated because of security risks in handling and using tokens on the
[client side](https://developers.google.com/identity#google-sign-in)

**Reachability of an access identity provide**

Make sure to set up the app in the API Console to enable it to use these protocols and authenticate users.
When a user tries to log in with Google, the following steps are required:


- [Create an anti-forgery state token ](https://developers.google.com/identity/protocols/oauth2/openid-connect#createxsrftoken)
- [Send an authentication request to Google](https://developers.google.com/identity/protocols/oauth2/openid-connect#sendauthrequest)
- [the anti-forgery state token](https://developers.google.com/identity/protocols/oauth2/openid-connect#confirmxsrftoken)
- [Exchange code for access token and ID token](https://developers.google.com/identity/protocols/oauth2/openid-connect#exchangecode)
- [Obtain user information from the ID token](https://developers.google.com/identity/protocols/oauth2/openid-connect#obtainuserinfo)
- [Authenticate the user](https://developers.google.com/identity/protocols/oauth2/openid-connect#authuser)

After creating an anti-forgery state token,
The next step is forming an HTTPS GET request with the appropriate URI parameters.
Note the use of HTTPS rather than HTTP in all the steps of this process; HTTP connections are refused.

For a basic request, specify the following parameters:
- client_id: which obtain from the API Console Credentials page
- response_type: which in a basic authorization code flow request should be code
- scope: which in a basic request should be openid email
- redirect_uri: should be the HTTP endpoint on  server that will receive the response from Google.
- state: should include the value of the anti-forgery unique session token,
as well as any other information needed to recover the context when the user returns to application, e.g., the starting URL.
- nonce: is a random value generated by app that enables replay protection when present.
- login_hint: can be the user's email address or the sub string, which is equivalent to the user's Google ID.
Use the [hd](https://developers.google.com/identity/protocols/oauth2/openid-connect#hd-param) parameter to optimize the
OpenID Connect flow for users of a particular domain associated with a Google Cloud organization.

Here is an example of a complete OpenID Connect authentication URI, with line breaks and spaces for readability:
```
{
https://accounts.google.com/o/oauth2/v2/auth?
 response_type=code&
 client_id=424911365001.apps.googleusercontent.com&
 scope=openid%20email&
 redirect_uri=https%3A//oauth2.example.com/code&
 state=security_token%3D138r5719ru3e1%26url%3Dhttps%3A%2F%2Foauth2-login-demo.example.com%2FmyHome&
 login_hint=jsmith@example.com&
 nonce=0394852-3190485-2490358&
 hd=example.com
}

```

The response includes a code parameter, a one-time authorization code that  server can exchange for an access token and ID token.
Server makes this exchange by sending an HTTPS POST request. The POST request is sent to the token endpoint,
which should retrieve from the Discovery document using the token_endpoint metadata value.
The request must include the following parameters in the POST body:

- Code: The authorization code that is returned from the initial request.
- Client_id: The client ID that obtain from the API Console Credentials page, as described in Obtain OAuth 2.0 credentials.
- Client_secret: The client secret that  obtain from the API Console Credentials page, as described in Obtain OAuth 2.0 credentials.
- Redirect_uri: An authorized redirect URI for the given client_id specified in the API Console Credentials page, as described in Set a redirect URI.
- Grant_type: This field must contain a value of authorization_code, as defined in the OAuth 2.0 specification.

The actual request might look like the following example:

```
{
POST /token HTTP/1.1
Host: oauth2.googleapis.com
Content-Type: application/x-www-form-urlencoded

code=4/P7q7W91a-oMsCeLvIaQm6bTrgtp7&
client_id=your-client-id&
client_secret=your-client-secret&
redirect_uri=https%3A//oauth2.example.com/code&
grant_type=authorization_code
}

```

A successful response to this request contains the following fields in a JSON array:

- Access_token:	A token that can be sent to a Google API.
- Expires_in: The remaining lifetime of the access token in seconds.
- Id_token:	A JWT that contains identity information about the user that is digitally signed by Google.
- Scope: The scopes of access granted by the access_token expressed as a list of space-delimited, case-sensitive strings.
- Token_type: Identifies the type of token returned. At this time, this field always has the value Bearer.
- Refresh_token: (optional) This field is only present if the access_type parameter was set to offline in the authentication request. For details, see Refresh tokens.


An ID token is a JSON object containing a set of name/value pairs .
[Obtain user information from the ID token](https://developers.google.com/identity/protocols/oauth2/openid-connect#obtainuserinfo) example is given below

```
{
  "iss": "https://accounts.google.com",
  "azp": "1234987819200.apps.googleusercontent.com",
  "aud": "1234987819200.apps.googleusercontent.com",
  "sub": "10769150350006150715113082367",
  "at_hash": "HK6E_P6Dh8Y93mRNtsDB1Q",
  "hd": "example.com",
  "email": "jsmith@example.com",
  "email_verified": "true",
  "iat": 1353601026,
  "exp": 1353604926,
  "nonce": "0394852-3190485-2490358"
}
```

**OpenID Connect Interface for the Google IdP**

[Interface Image 1](https://docs.uipath.com/orchestrator/v2020.4/docs/google-authentication-using-openid-connect)

[Interface Image 2](https://www.oauth.com/oauth2-servers/signing-in-with-google/authorization-request/)

The complete documentation can be found [here](https://developers.google.com/identity/protocols/oauth2/openid-connect)

